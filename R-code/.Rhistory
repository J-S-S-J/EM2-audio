library(tidyverse)
path <- "~/Desktop/Python/EM2-audio/experiment/control_experiment/data_detection/god_data"
all_files <- fs::dir_ls(path, glob = "*.csv")
path <- "~/Desktop/Python/EM2-audio/experiment/control_experiment/data_detection/gammel_data"
all_files <- fs::dir_ls(path, glob = "*.csv")
raw_data <- map_dfr(all_files, read_csv, .id = "source_file")
library(tidyverse)
path <- "~/Desktop/Python/EM2-audio/experiment/control_experiment/data_detection/gammel_data"
all_files <- fs::dir_ls(path, glob = "*.csv")
raw_data <- map_dfr(all_files, read_csv, .id = "source_file")
tidy_data <- raw_data %>%
# --- Remove Practice Trials ---
# This logic is still correct. We keep rows where the 'main'
# loop was running (i.e., 'main.thisN' is not NA).
filter(!is.na(main.thisN)) %>%
# --- Select Only the Useful Columns ---
# We use the REAL column names from your glimpse() output.
# Use backticks `` for names with spaces like `Participant ID`.
select(
# Participant info
participant = `Participant ID`, # Rename `Participant ID` to `participant`
session = Session,          # Rename `Session` to `session`
# Trial info
trial_num = main.thisN,     # This is the trial number
# Experiment condition columns (from your data)
signal_type,
compression_level,
prime_file,
correct_word,
babbling_file,
mask1_file,
mask2_file,
# Dependent Variables (the participant's response)
key_pressed = response_key, # Rename `response_key` to `key_pressed`
rt,
trial_outcome
) %>%
# --- Fix Data Types ---
# Convert columns to the correct type for analysis
mutate(
# Convert RT to numeric
rt = as.numeric(rt),
# Convert key identifiers to factors (categorical variables)
participant = as.factor(participant),
session = as.factor(session),
key_pressed = as.factor(key_pressed),
# Convert valences to factors
signal_type = as.factor(signal_type),
trial_outcome = as.factor(trial_outcome)
)
# 4. SHOW THE RESULT
#------------------------------------------------------------------
# Print the first few rows of your new, clean data frame
print(tidy_data)
# Show a summary of the data frame structure
glimpse(tidy_data)
# Load the ggplot2 library (part of tidyverse)
library(ggplot2)
# Create the 100% stacked bar chart
# We use the 'tidy_data' data frame from the previous step
compression_plot <- ggplot(tidy_data, aes(x = factor(compression_level), fill = trial_outcome)) +
# geom_bar(position = "fill") creates a 100% stacked bar chart,
# which is perfect for comparing proportions across groups.
geom_bar(position = "fill") +
# Add clear labels
labs(
title = "Proportion of Trial Outcomes by Compression Level",
x = "Compression Level",
y = "Proportion",
fill = "Trial Outcome"
) +
# Format the y-axis to show percentages (e.g., 25%, 50%)
scale_y_continuous(labels = scales::percent_format()) +
# Apply a clean theme
theme_minimal()
# Save the plot to a file
ggsave("compression_outcomes_plot.png", plot = compression_plot, width = 10, height = 6)
# Print the plot object so it displays
print(compression_plot)
path <- "~/Desktop/Python/EM2-audio/experiment/control_experiment/data_detection/ny_data"
all_files <- fs::dir_ls(path, glob = "*.csv")
raw_data <- map_dfr(all_files, read_csv, .id = "source_file")
library(tidyverse)
path <- "~/Desktop/Python/EM2-audio/experiment/control_experiment/data_detection/ny_data"
all_files <- fs::dir_ls(path, glob = "*.csv")
raw_data <- map_dfr(all_files, read_csv, .id = "source_file")
tidy_data <- raw_data %>%
# --- Remove Practice Trials ---
# This logic is still correct. We keep rows where the 'main'
# loop was running (i.e., 'main.thisN' is not NA).
filter(!is.na(main.thisN)) %>%
# --- Select Only the Useful Columns ---
# We use the REAL column names from your glimpse() output.
# Use backticks `` for names with spaces like `Participant ID`.
select(
# Participant info
participant = `Participant ID`, # Rename `Participant ID` to `participant`
session = Session,          # Rename `Session` to `session`
# Trial info
trial_num = main.thisN,     # This is the trial number
# Experiment condition columns (from your data)
signal_type,
compression_level,
prime_file,
correct_word,
babbling_file,
mask1_file,
mask2_file,
# Dependent Variables (the participant's response)
key_pressed = response_key, # Rename `response_key` to `key_pressed`
rt,
trial_outcome
) %>%
# --- Fix Data Types ---
# Convert columns to the correct type for analysis
mutate(
# Convert RT to numeric
rt = as.numeric(rt),
# Convert key identifiers to factors (categorical variables)
participant = as.factor(participant),
session = as.factor(session),
key_pressed = as.factor(key_pressed),
# Convert valences to factors
signal_type = as.factor(signal_type),
trial_outcome = as.factor(trial_outcome)
)
# 4. SHOW THE RESULT
#------------------------------------------------------------------
# Print the first few rows of your new, clean data frame
print(tidy_data)
# Show a summary of the data frame structure
glimpse(tidy_data)
# Load the ggplot2 library (part of tidyverse)
library(ggplot2)
# Create the 100% stacked bar chart
# We use the 'tidy_data' data frame from the previous step
compression_plot <- ggplot(tidy_data, aes(x = factor(compression_level), fill = trial_outcome)) +
# geom_bar(position = "fill") creates a 100% stacked bar chart,
# which is perfect for comparing proportions across groups.
geom_bar(position = "fill") +
# Add clear labels
labs(
title = "Proportion of Trial Outcomes by Compression Level",
x = "Compression Level",
y = "Proportion",
fill = "Trial Outcome"
) +
# Format the y-axis to show percentages (e.g., 25%, 50%)
scale_y_continuous(labels = scales::percent_format()) +
# Apply a clean theme
theme_minimal()
# Save the plot to a file
ggsave("compression_outcomes_plot.png", plot = compression_plot, width = 10, height = 6)
# Print the plot object so it displays
print(compression_plot)
